<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plyr.js Video Example with HLS and Quality Selection</title>
<link rel="stylesheet" href="dark.css" id="theme-link">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/menifest.json">
    <style>
        .plyr {
            font-family: 'Poppins', sans-serif;
        }
        .plyr {
            color: #fff !important;
        }
        .plyr--audio, .plyr--video {
            background-color: #333 !important;
        }
        .plyr__controls .plyr__control.plyr__control--overlaid svg path,
        .plyr__controls .plyr__control.plyr__control--overlaid svg polygon {
            fill: #fff !important;
        }
        .plyr__controls .plyr__menu__container {
            background: #333 !important;
        }
        .plyr__control, .plyr__control:hover, .plyr__control:focus {
            color: #fff !important;
        }
        .plyr__progress--played, .plyr__volume--display {
            background: #fff !important;
        }
        .plyr__progress--buffer {
            background: rgba(255, 255, 255, 0.5) !important;
        }
        .plyr__progress--played {
            background: #fff !important;
        }
        .plyr__volume--display::before {
            background: #fff !important;
        }
        .plyr__volume--display::after {
            background: #fff !important;
        }
        .plyr__tooltip {
            background: #333 !important;
            color: #fff !important;
        }
        .plyr__controls .plyr__time {
            color: #fff !important;
        }
        .plyr__controls button[aria-expanded="true"]::after {
            color: #fff !important;
        }
        .plyr__controls button:hover, .plyr__controls button:focus {
            background: rgba(255, 255, 255, 0.1) !important;
        }
        body {
          background-color: rgba(0,0,0,.1);
          margin: 0;
          width: 100%;
          height: 40vh;
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
        }


.glass{
  width: 100%;
  height: 60vh;
/* Add Rgb With Back Drop Filter*/
  position: absolute;
  background-color: rgba(255,255,255,.5);
  backdrop-filter: blur(10px);
}

.bgb{
  width: 100%;
  height: 60vh;
  z-index: -1;
  position: relative;
  background-image: url('https://cdn.sex.com/images/pinporn/2022/03/13/26864205.gif?width=460');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
}
        .col-6 {
            width: 100%;
            min-height: 26vh;
            max-height: 28vh;
        }
        .placeholder {
            background-color: rgba(10, 142, 199, 1);
        }
        .card-body {
            margin: 0px;
            padding: 0px;
        }
        .card {
            position: relative;
        }

.image-placeholder {
    width: 300px; /* Adjust width as needed */
    height: 200px; /* Adjust height as needed */
    background: linear-gradient(to bottom right, rgba(0,0,0,1), #dddddd); /* Adjust gradient colors as needed */
}

.card{
  padding: 0;
}

/* Pop-up Box Styles */
.theme-popup {
    display: flex; /* Use flexbox to center the content */
    position: fixed;
    justify-content: center; /* Horizontally center the content */
    align-items: center; /* Vertically center the content */
    top: 50%; /* Position at 50% from the top */
    left: 50%; /* Position at 50% from the left */
    transform: translate(-50%, -50%); /* Move back by 50% of its own width and height */
    padding: 10px 20px;
    background-color: #fff;
    color: #333;
    border-radius: 5px;
    z-index: 1000;
    opacity: 0;
    transition: opacity .5s ease-in-out;
}

/* Fade-in animation */
.show-popup {
    display: block;
    opacity: 1;
}
        
.placeholder-container {
    position: relative;
}

.placeholder-background {
  padding: 15px;
    width: 100%;
    height: 25vh; /* Adjust height as needed */
    background-color: #f0f0f0; /* Adjust background color as needed */
}

.placeholder-wave {
    width: 100%;
    height: 25vh;
    position: absolute;
    top: 0;
    left: 0;
    overflow: hidden;
}



.placeholder-wave::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 200%;
    height: 100%;
    background: linear-gradient(to right, transparent 0%, rgba(0,0,0,.1) 50%, transparent 100%);
    animation: wave-animation 1.5s infinite;
}

@keyframes wave-animation {
    0% {
        transform: translateX(0);
    }
    100% {
        transform: translateX(100%);
    }
}



.m3u8-player{
    opacity: 0;
    animation: fadeIn 2s forwards;
    box-shadow: rgba(0,0,0,.5) 0px 2px 4px 0px, rgba(255,255,255,.5) 0px 2px 16px 0px;
}
.m3u8-player {
  border: 5px solid rgba(0,0,0,.1);
  padding: 15px;
}

@keyframes fadeIn {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 1;
    }
}
/* CSS code to center the spinner within the buffer shower */
.buffer-shower {
    display: flex;
    justify-content: center;
    align-items: center;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(5px);/* Semi-transparent white background */
    z-index: 1000; /* Ensure the spinner is above other content */
}

.spinner-grow-container {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
}

.popup-container {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 20px;
    border-radius: 5px;
    z-index: 1000;
    display: none;
}

.popup-container::after {
    content: '';
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    border-width: 10px;
    border-style: solid;
    border-color: transparent transparent rgba(0, 0, 0, 0.8) transparent;
}

#addButton{
  transition: transform 0.5s ease
  box-shadow: inset -15px 0 25px -15px rgba(0, 0, 0, 0.5);
  color: rgba(255,255,255,.6);
  background-color: rgba(0,0,0,1);
}
#addButton:hover{
  transform: scale(.95);
  color: rgba(255,255,255,1);
  background-color: rgba(0,0,0,.7);
}

#pasteButton{
  transition: transform 0.5s ease
  color: rgba(255,255,255,.6);
  background-color: rgba(0,0,0,1);
}

#pasteButton:hover{
  transform: scale(.95);
  color: rgba(255,255,255,1);
  background-color: rgba(0,0,0,.7);
}

.form-control{
  box-shadow: rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, rgba(255, 255, 255, 0.08) 0px 1px 0px inset;
}
    </style>
</head>
<body>
  
<!-- Pop-up message container -->
<div id="themePopup" class="theme-popup"></div>
<!-- Pop-up message container -->
<div id="popupContainer" class="popup-container"></div> 



<!-- Spinner -->
<div id="bufferShower" class="buffer-shower" style="display:none;">
    <div class="spinner-grow-container">
        <div class="spinner-grow" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
</div>



    <div class="container mt-3">
        <div class="input-group mb-3">
            <input type="text" id="m3u8Input" class="form-control" placeholder="Enter .m3u8 link" aria-label="m3u8 link">
            <button class="btn btn-outline-secondary" type="button" id="pasteButton">
                <i class="bi bi-clipboard"></i>
            </button>
            <button class="btn btn-light" type="button" id="addButton" style="display:none;">
                <i class="bi bi-box-arrow-in-left"></i>
            </button>
        </div>
    </div>
   
   <div class="m3u8-player">
    <!-- Video Element -->
    <div id="video-container">
        <video id="player" style="position:absolute" style="display:none" playsinline controls></video>
    </div>

<div class="loader">
<div id="lazy" aria-hidden="true" style="opacity:1;">
    <div class="placeholder-container">
        <div class="placeholder-background"></div>
        <div class="placeholder-wave"></div>
    </div>
</div>
</div>
</div>

          <div class="glass"></div>
<div class="bgb" style="display:block;"></div>



<script>
document.addEventListener('DOMContentLoaded', function() {
    // Hide the buffer shower when the page loads
    document.getElementById('bufferShower').style.opacity = '0';
});

// Function to hide the buffer shower when the video has fully loaded
document.getElementById('player').addEventListener('canplaythrough', function() {
    // Gradually fade out the buffer shower
    fadeOut(document.getElementById('bufferShower'));
});

// Function to show the buffer shower when the video starts buffering
document.getElementById('player').addEventListener('loadstart', function() {
    // Gradually fade in the buffer shower
    fadeIn(document.getElementById('bufferShower'));
});

function fadeOut(element) {
    var opacity = 1;
    var intervalId = setInterval(function() {
        if (opacity > 0) {
            opacity -= 0.1;
            element.style.opacity = opacity;
        } else {
            clearInterval(intervalId);
            element.style.display = 'none';
        }
    }, 5);
}

function fadeIn(element) {
    var opacity = 0;
    element.style.display = 'block';
    var intervalId = setInterval(function() {
        if (opacity < 1) {
            opacity += 0.1;
            element.style.opacity = opacity;
        } else {
            clearInterval(intervalId);
        }
    }, 5);
}

</script>    
<script>
  // Function to detect user's preferred color scheme
function detectColorScheme() {
    const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    return isDarkMode ? 'dark' : 'light';
}

// Function to apply the selected theme
function applyTheme(theme) {
    const body = document.body;
    if (theme === 'dark') {
        body.classList.add('dark-mode');
    } else {
        body.classList.remove('dark-mode');
    }
}

// Function to display theme change message
function displayThemeChangeMessage(theme) {
    console.log(`Switched to ${theme} theme`);
}

// Function to show the pop-up message
function showThemeMessage(theme) {
    const popup = document.getElementById('themePopup');
    popup.textContent = `User theme: ${theme}`;
    popup.classList.add('show-popup');

    // Hide the pop-up after 5 seconds
    setTimeout(() => {
        popup.classList.remove('show-popup');
    }, 5000);
}

// Hide body content until the theme is applied
document.body.style.display = 'none';

// Detect user's theme on page load and apply the theme
document.addEventListener('DOMContentLoaded', () => {
    const userTheme = detectColorScheme();
    applyTheme(userTheme);
    console.log(`User theme: ${userTheme}`);
    document.body.style.display = ''; // Unhide body content after applying the theme

    // Show the theme pop-up message after a 2-second delay
    setTimeout(() => {
        showThemeMessage(userTheme);
    }, 2000);
});

// Event listener to detect changes in user's preferred color scheme
const mediaQueryList = window.matchMedia('(prefers-color-scheme: dark)');
mediaQueryList.addEventListener('change', e => {
    const newTheme = e.matches ? 'dark' : 'light';
    applyTheme(newTheme);
    console.log(`User theme changed to ${newTheme}`);
    showThemeMessage(newTheme);
    setTimeout(() => {
        location.reload(); // Reload the page to apply the theme changes
    }, 5000); // Refresh after 5 seconds to allow user to see the message
});

// Event listener to handle theme changes initiated by the user
document.body.addEventListener('click', (event) => {
    if (event.target.id === 'toggleThemeButton') {
        const currentTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
        applyTheme(currentTheme);
        displayThemeChangeMessage(currentTheme);
        localStorage.setItem('theme', currentTheme); // Save theme preference in local storage
        showThemeMessage(currentTheme);
        setTimeout(() => {
            location.reload(); // Reload the page to apply the theme changes
        }, 5000); // Refresh after 5 seconds to allow user to see the message
    }
});

</script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
    const video = document.getElementById('player');
    const videoContainer = document.getElementById('lazy');
    video.addEventListener('loadeddata', () => {
        console.log('Video has been loaded');
        videoContainer.style.opacity = '0';
        player.style.position = 'relative';
        lazy.style.display = 'none';
    });
});

document.addEventListener('DOMContentLoaded', () => {
    const video = document.getElementById('player');
    const videoContainer = document.getElementById('video-container');
    video.addEventListener('loadeddata', () => {
        console.log('Video has been loaded');
        videoContainer.style.display = 'block';
    });
});

document.getElementById('addButton').addEventListener('click', () => {
    const source = document.getElementById('m3u8Input').value;
    const video = document.querySelector('video');
    const defaultOptions = {};

    if (!Hls.isSupported()) {
        video.src = source;
        var player = new Plyr(video, defaultOptions);
    } else {
        const hls = new Hls();
        hls.loadSource(source);

        hls.on(Hls.Events.MANIFEST_PARSED, function (event, data) {
            const availableQualities = hls.levels.map((l) => l.height);
            availableQualities.unshift(0);

            defaultOptions.quality = {
                default: 0,
                options: availableQualities,
                forced: true,
                onChange: (e) => updateQuality(e),
            }

            defaultOptions.i18n = {
                qualityLabel: {
                    0: 'Auto',
                },
            }

            hls.on(Hls.Events.LEVEL_SWITCHED, function (event, data) {
                var span = document.querySelector(".plyr__menu__container [data-plyr='quality'][value='0'] span")
                if (hls.autoLevelEnabled) {
                    span.innerHTML = `AUTO (${hls.levels[data.level].height}p)`
                } else {
                    span.innerHTML = `AUTO`
                }
            })

            var player = new Plyr(video, defaultOptions);
        });
        hls.attachMedia(video);
        window.hls = hls;
    }

    function updateQuality(newQuality) {
        if (newQuality === 0) {
            window.hls.currentLevel = -1;
        } else {
            window.hls.levels.forEach((level, levelIndex) => {
                if (level.height === newQuality) {
                    console.log("Found quality match with " + newQuality);
                    window.hls.currentLevel = levelIndex;
                }
            });
        }
    }
});

function showPopup(message) {
    const popupContainer = document.getElementById('popupContainer');
    popupContainer.textContent = message;
    popupContainer.style.display = 'block';

    // Hide the pop-up after a certain time (e.g., 3 seconds)
    setTimeout(() => {
        popupContainer.style.display = 'none';
    }, 3000);
}
document.getElementById('addButton').addEventListener('click', () => {
    const source = document.getElementById('m3u8Input').value.trim();

    if (source === '') {
        // Show pop-up message
        showPopup('Please enter a .m3u8 link');
        return; // Ignore further execution
    }

    // Your HLS code here
});

document.getElementById('pasteButton').addEventListener('click', async () => {
    try {
        const text = await navigator.clipboard.readText();
        document.getElementById('m3u8Input').value = text;
        
        // After pasting, check if the input contains a valid .m3u8 link
        const input = document.getElementById('m3u8Input');
        const addButton = document.getElementById('addButton');
        const source = input.value.trim();

        if (source === '' || !source.endsWith('.m3u8')) {
            addButton.style.display = 'none'; // Hide button when input is empty or not a .m3u8 link
        } else {
            addButton.style.display = 'block'; // Show button when input is a .m3u8 link
        }
    } catch (err) {
        console.error('Failed to read clipboard: ', err);
    }
});


document.getElementById('m3u8Input').addEventListener('input', () => {
    const input = document.getElementById('m3u8Input');
    const addButton = document.getElementById('addButton');
    const source = input.value.trim();

    if (source === '' || !source.endsWith('.m3u8')) {
        addButton.style.display = 'none'; // Hide button when input is empty or not a .m3u8 link
    } else {
        addButton.style.display = 'block'; // Show button when input is a .m3u8 link
    }
});


    </script>

    <!-- Plyr JavaScript -->
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <!-- hls.js -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</body>
</html>
